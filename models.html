<!DOCTYPE HTML>

<html>
	<head>
		<script type="x-shader/x-vertex" id="vshader">
			attribute vec3 aPosition;
			attribute vec3 aNormal;
			attribute vec2 aTexCoords;

			uniform mat4 uModel;
			uniform mat4 uView;
			uniform mat4 uProjection;
			uniform mat4 uNormal;
			uniform vec3 uMaterialDiffuse;
			uniform vec3 uLightDiffuse;

			uniform vec3 uLightPosition;
			
			varying vec3 vPosition;
			varying vec2 vTexCoords;
			varying vec4 vColor;
			void main() {
				
				gl_Position = uProjection * uView * uModel * vec4(aPosition,1.0);
				vec3 vertexPosition = vec3(uModel * vec4(aPosition,1.0)); 
				vPosition =  vertexPosition;
				
				vec3 corrected_aNormal = vec3(uNormal * vec4(aNormal,1.0));
				vec3 normalized_aNormal = normalize(corrected_aNormal);

				vec3 computedLightDirection = aPosition - uLightPosition;
				vec3 normalized_lightDirection = normalize(computedLightDirection);
				
				float lambertCoefficient = max(dot(-normalized_lightDirection,normalized_aNormal),0.0);
				vec3 diffuseColor =  uLightDiffuse * uMaterialDiffuse * lambertCoefficient;

				vColor = vec4(diffuseColor,0.5);
				vTexCoords = aTexCoords;
			}
		</script>
		<script type="x-shader/x-fragment" id="fshader">
			precision mediump float;
			uniform sampler2D uSampler;

			varying vec2 vTexCoords;
			varying vec3 vPosition;
			varying vec4 vColor;	
			void main() {
				gl_FragColor = texture2D(uSampler, vTexCoords);
			}
		</script>
		<script type="text/javascript" src="initUtils.js"></script>
		<script type="text/javascript" src="gl-matrix-min.js"></script>
		<script type="text/javascript" src="load_file.js"></script>
		<script type="text/javascript" src="floor.js"></script>
		<script type="text/javascript" src="walls.js"></script>
		<script type="text/javascript" src="stair_step.js"></script>
		<script type="text/javascript" src="labRoom.js"></script>
		<script type="text/javascript" src="patio_kitchen.js"></script>
		<script type="text/javascript" src="comfortroom.js"></script>
		<script type="text/javascript" src="boardroom.js"></script>
		<script type="text/javascript" src="loungeroom.js"></script>
		<script>
			function main() {
				var canvas = document.getElementById("c");
				var gl = initializeWebGL(canvas);
				var vertexShader = initializeShader(gl,"vshader");
				var fragmentShader = initializeShader(gl, "fshader");
				var program = initializeProgram(gl,vertexShader,fragmentShader);
				gl.useProgram(program);
				
				//create_flat_screen_tv(gl, program, canvas, 0, 0, 0, 0, 0, 0);
				//create_microwave(gl, program, canvas, 0, 0, 0, 0, 0, 0);
				//create_pc(gl, program, canvas, 0, 0, 0, 0, 0, 0);
				//create_refrigerator(gl, program, canvas, 0, 0, 0, 0, 0, 0);
				//create_urinal(gl, program, canvas, 0, 0, 0, 0, 0, 0);
				//create_conference_table(gl, program, canvas, 0, 0, 0, 0, 0, 0);
				full_metal_wall(gl, program, canvas, 0, 0, 0, 0, 0, 0);
				
			}
		</script>
	</head>
	<body onload="main()">
		<canvas id="c" width="1000" height="1000" style="border: 1px black solid; ">
		</canvas>
	</body>
</html>